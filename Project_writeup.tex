\documentclass[12pt,twoside]{article}

%\usepackage{amsthm}%
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage[margin=1in]{geometry}
\usepackage{enumerate}
\usepackage{verbatim}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage[]{algorithm2e}

\newenvironment{proof}{\noindent{\bf Proof:} \hspace*{1mm}}{
	\hspace*{\fill} $\Box$ }
\newenvironment{proof_of}[1]{\noindent {\bf Proof of #1:}
	\hspace*{1mm}}{\hspace*{\fill} $\Box$ }
\newenvironment{proof_claim}{\begin{quotation} \noindent}{
	\hspace*{\fill} $\diamond$ \end{quotation}}

\newtheorem{thm}{Theorem}
\newtheorem{lemma}[thm]{Lemma}

\newcommand{\mbf}{\mathbf}
\newcommand{\mrm}{\mathrm}

\newenvironment{centered}[0]{%
  \begin{list}{}{%
    \setlength{\topsep}{0pt}%
    \setlength{\leftmargin}{.25in}%
    \setlength{\rightmargin}{.25in}%
    \setlength{\listparindent}{\parindent}%
    \setlength{\itemindent}{\parindent}%
    \setlength{\parsep}{\parskip}%
  }
  \item[]}{\end{list}}
\newcommand\abs[1]{\left|#1\right|}
\newcommand\given[1][]{\:#1\vert\:}
\newcommand{\legendre}[2]{\genfrac{(}{)}{}{}{#1}{#2}}
\setcounter{tocdepth}{1}
\newtheorem{theorem}{Theorem}



\title{Constructing Pairing-Friendly Elliptic Curves }
\date{\today}
\author{ Peter Manohar, Xingyou Song} 

\begin{document}

\maketitle

\abstract{The goal of this report is to....
}

\tableofcontents

\section{Introduction}

In this section, we shall define key concepts needed for our report. We will prove some of the more important results, and cite a source otherwise.

\subsection{Elliptic Curves} 
For our project, we shall define an elliptic curve to be a curve of the form:
\begin{equation}
E: \ y^2 = x^3 + Ax + B 
\end{equation}
where $A$ and $B$ are elements of some field $\mathbb F$, with char$(\mathbb F) \ne 2,3$. The curve $E$ is nonsingular if $\frac{\partial F}{\partial x}$ and $\frac{\partial F}{\partial y}$ are not simultaneously $0$ for all points on $E$. It follows that $E$ is nonsingular $\iff x^3+ Ax+ B$ has distinct roots. Through Vieta's formulas, $E$ has distinct roots $\iff ((r_{1} - r_{2})(r_{1} - r_{3})(r_{2} - r_{3}))^{2} = -(4A^{3} + 27B^{2})$ is nonzero. Therefore, we shall also require that the discriminant of $E$,
\begin{equation} 
\Delta = -16(4A^{3} + 27B^{2})
\end{equation}
is nonzero. 
The j-invariant of $E$ is defined by:
\begin{equation}
j(E) = 1728 \frac{4A^{3}}{4A^{3} + 27B^{2}}
\end{equation}
\subsection{Group Law} 
The points on an elliptic curve form an additive abelian group. We shall define the group law geometrically. \\
Let $P = (x_p, y_p), Q = (x_q, y_q)$. A line through $P$ and $Q$ intersects $E$ at a third point, $R = (x_r,y_r)$. We define $P + Q := (x_r,-y_r)$. Pictorally, this looks like \\
\includegraphics[width=6in]{grouplaw.png}
The group law can also be defined in terms of algebraic formulas, which can be found in [SIL08]. %[1] is silverman%

\subsection{Notation}
\begin{itemize}
\item $\mathbb F$ is a field
\item $\overline{\mathbb F}$ is the algebraic closure of $\mathbb F$
\item $\mathbb F_p$ is a field with $p$ elements, where $p$ is prime
\item $E(\mathbb F) = \{\mathbb F \times \mathbb F \given E(x,y) = 0\}$
\item $\phi$ is an isogeny (or endomorphism)
\item $\phi_p$ is the Frobenius endomorphism
\item $[n]$ is the multiplication by $n$ map
\end{itemize}



\subsection{Isogenies} 
An isogeny of two elliptic curves $E_1$ and $E_2$ defined over a field $\mathbb F$ is a nonconstant morphism $\phi: E_1 \to E_2$, where $\phi$ is a group homomorphism from $E_1(\overline{\mathbb F}) \to E_2(\overline{\mathbb F})$. $E_1$ and $E_2$ are isomorphic if $\exists \phi_1: E_1 \to E_2$ and $\phi_2: E_2 \to E_1$, isogenies, such that $\phi_2 \circ \phi_1 =  $ Identity.

\subsubsection{Separable and Inseparable Isogenies}
Any isogeny $\phi$ can be expressed as $\phi(x,y) = (\frac{u(x)}{v(x)}, \frac{s(x)}{t(x)}y)$, where $u,v,s,t \in \mathbb F[x]$, and $\gcd(u,v) = \gcd(s,t) = 1$. [SUTH15] %[3] is mit reference
An isogeny is separable if $(\frac{u}{v})' = 0$, and is inseparable otherwise. The degree of an isogeny is defined as $\deg(\phi) := \max(\deg(u), \deg(v))$. [SUTH15]
For any separable isogeny $\phi$, $\deg(\phi) = \abs{ \ker \phi}$.

\subsubsection{Dual isogenies}
\begin{theorem}
Let $\phi: E_1 \to E_2$ be an isogeny. Then $\exists$ a unique $\hat{\phi}: E_2 \to E_1$ such that $\hat \phi \circ \phi = [n]$, where $n = \deg(\phi)$.
\end{theorem}
\noindent The proof of this can be found in either [SIL08] or [SUTH15]. Furthermore, for any two isogenies $\phi_1$ and $\phi_2$, $\widehat{\phi_1 + \phi_2} = \hat \phi_1 + \hat \phi_2$.
\subsection{Endomorphisms}

An endomorphism is an isogeny from $E$ to itself. The endomorphisms of $E$ form a ring, where addition is addition of functions and multiplication is function composition.

\subsubsection{Examples}

The map $[n]: E \to E$, where $[n]P = P + P + \dots + P$ ($n$ times) is an endomorphism.
\\ \\
\noindent If $E$ is defined over $\mathbb F_p$, the Frobenius map $\phi_p: E \to E$ defined by $\phi_p(x,y) := (x^p, y^p)$ is an (inseparable) endomorphism.

\subsubsection{Trace of an Endomorphism}

\begin{theorem}
For any endomorphism $\phi$, $\phi + \hat \phi = 1 + \deg(\phi) - \deg(1-\phi)$, where we can regard the RHS as an endomorphism by the map $n \mapsto [n]$.
\end{theorem}
\begin{proof}
As endomorphisms, 
\begin{flalign*}
& [\deg(1-\phi)] = \widehat{(1-\phi)}(1-\phi) = (\hat 1 - \hat \phi)(1-\phi) = (1 - \hat \phi)(1-\phi) \\
&= 1 - \hat \phi - \phi + \hat \phi \circ \phi = 1 - \hat \phi - \phi + [\deg(\phi)] \\
& \implies \phi + \hat \phi = 1+ [\deg(\phi)] - [\deg(1- \phi)] 
\end{flalign*}
\end{proof}
\\
By the above theorem, we can now define trace$(\phi) := \phi + \hat \phi$.
\begin{theorem}
$\#E(\mathbb F_p) = p + 1 - t$, where $t = {\rm trace}(\phi_p)$
\end{theorem}
\begin{proof}
The fixed field of $\phi_p$ is $\mathbb F_p$, and $1- \phi_p$ is separable (see [SUTH15]). Therefore, $\ker(1- \phi_p) = \#E(\mathbb F_p)$. It is clear that $\deg(\phi_p) = p$ by definition ($u(x) = x^p$ and $v(x) = 1$). We have that
\begin{flalign*}
&\ker(1-\phi_p) = \deg(1-\phi_p) = 1 + \deg(\phi_p) - {\rm trace}(\phi_p) = p + 1 - t \\
&\implies \#E(\mathbb F_p) = p + 1 -t
\end{flalign*}
\end{proof}


\bigskip


\begin{theorem} 
If $K$ is a field of characteristic $0$ or does not divide $m$, then
$ E[m] \simeq Z_{m} \oplus Z_{m}$.  
\end{theorem} 
The proof of this is mainly using the fundamental theorem of abelian groups, and analyzing the decomposition of the torsion group (TODO?) 



\subsection{j-invariant} 

\begin{theorem}
Two elliptic curves $E_1(\mathbb F)$ and $E_2(\mathbb F)$ are isomorphic over $\overline{\mathbb F} \iff j(E_1) = j(E_2)$. Furthermore, $\forall j_0 \in \overline{\mathbb F}$, $\exists$ an elliptic curve $E(\mathbb F)$ such that $j(E) = j_0$.
\end{theorem}
The proof requires some lengthy algebraic manipulation, which can be found in [SIL08]. As a consequence of the proof, for any $j \in \overline{\mathbb F}$, we can define an canonical elliptic curve $E$ associated with this j-invariant. We see that 

  
\begin{flalign} 
& E: y^{2}  = x^{3} + \frac{3j}{1728 - j}x + \frac{2j}{1728 - j} \text{\ if \ } j \ne 0, 1728\\
\nonumber & E: y^2 = x^3 + 1 \text{\ if \ }  j = 0 \\
\nonumber & E: y^2 = x^3 + x \text{\ if \ } j = 1728
\end{flalign}

\begin{comment}
A question arises when two elliptic curves over a field $E_{1}(K), E_{2}(K)$ are have a bijective isogeny, i.e. are isomorphic with respect to the group law. 
An intuitive answer is that the points on elliptic curves be transformed algebraically, which will use different Weierstrass Equations

Note the transformation  

\begin{align*}
x' = \mu^{2}x \\   
y' = \mu^{3}y 
\end{align*}

implies, after plugging into the Weierstrass equation,

\begin{equation} 
(y')^{2} = (x')^{3} + \mu^{4}Ax' +\mu^{6}B \implies (y')^{2} = (x')^{3} + A'x' + B'  
\end{equation} 
where $A' = \mu^{4}A, B' = \mu_{6}B$. $\mu$ may not exist in the field $K$, but only in its closure $\bar{K}$. 

From here, we define the j-invariant $j$ of a Weierstrass Form to be 
\begin{equation} 
j(E) = 1728 \frac{4A^{3}}{4A^{3} + 27B^{2}}
\end{equation}

Note that the $j$ invariant is homogenous; scalings of the form from (5) will still leave $j$ constant. Given a $j$, then the canonical elliptic curve associated with this j-invariant will be 
\end{comment}

\subsubsection{Example}
$E_1(\mathbb F)$ and $E_2(\mathbb F)$ can be isomorphic over $\overline{\mathbb F}$, but not over $\mathbb F$. As an example, consider the curves $E_1: y^{2} = x^{3} - 25x$, $E_2: y^{2} = x^{3} - 4x$ have $j=1728$. $\#E_1(\mathbb Q) = \infty$ because we can just take an infinite group with generator $(-4,6)$ but $\#E_2(\mathbb Q) < \infty$ because the only points on it $\infty, (2,0), (-2,0), (0,0)$ form a finite abelian group. \\
The transformation $(x,y) \rightarrow (\mu^{2}x, \mu^{3}y)$, $\mu = \frac{\sqrt{10}}{2}$ establishes an isomorphism over $\mathbb Q(\sqrt{10})$, but no such isomorphism exists over $\mathbb Q$.

From this example, we can see that we do not necessarily need the full closure $\overline{\mathbb F}$; we only needed $d \in \mathbb F$ such that $d= \mu^{2}$, which in this case was $\mathbb Q(\sqrt{10})$, which gives rise to the idea of quadratic twists. 

\subsection{Twists} 
Two curves $E_1(\mathbb F)$ and $E_2(\mathbb F)$ are {\it twists} if they are isomorphic over $\overline{\mathbb F}$ but not over $\mathbb F$.
\subsubsection{Quadratic Twists}
In particular, we are interested in quadratic twists. If $E: y^2 = x^3 + Ax+ B$ is an elliptic curve defined over $\mathbb F$, and $d \in \mathbb F$ is a nonsquare, then we define the {\it quadratic twist of E} as $\tilde E: y^2 = x^3 + d^2Ax + d^3B$.

\begin{theorem}
If $E: y^2 = x^3 + Ax + B$ is an elliptic curve over $\mathbb F_p$ with $\#E(\mathbb F_p) = p+ 1 - t$, then $\#\tilde E(\mathbb F_p) = p+ 1 + t$
\end{theorem}
\begin{proof}
Let $\legendre{\cdot}{p}$ be the legendre symbol mod $p$. For any $x \in \mathbb F_p$, we see that $1 + \legendre{x^3+Ax+B}{p} = $ \# of points on $E$ with x-coordinate $x$. Therefore, 
\begin{flalign*}
\#E(\mathbb F_p) = 1 + \sum_{x \in \mathbb F_p} {(1 + \legendre{x^3+Ax+B}{p})} = p + 1 + \sum_{x \in \mathbb F_p} {\legendre{x^3+Ax+B}{p}}
\end{flalign*}
Since $\mathbb F_p$ is a field, $\forall x \in \mathbb F_p$, $\exists x' \in \mathbb F_p$ such that $d x' = x$. Therefore, for $\tilde E(\mathbb F_p$, we have that
\begin{flalign*}
&\#\tilde E(\mathbb F_p) = 1 + \sum_{x \in \mathbb F_p} {(1 + \legendre{(dx)^3+A(dx)+B}{p})} = p + 1 + \sum_{x \in \mathbb F_p} {\legendre{d^3(x^3+Ax+B)}{p}} \\
& = p + 1 + \sum_{x \in \mathbb F_p} {\legendre{d}{p} \legendre{d^2}{p} \legendre{x^3+Ax+B}{p}} = p + 1 - \sum_{x \in \mathbb F_p} {\legendre{x^3+Ax+B}{p}}
\end{flalign*}
\end{proof}

\subsection{The Complex Lattice}
\begin{theorem} 
Let $\omega_{1}, \omega_{2}$ be linearly independent points in $C$. Then define the lattice 
$$ L = Z\omega_{1} + Z \omega_{2}$$ Then there exists an elliptic curve that is isomorphic to $\mathbb{C}/ L$. 
\end{theorem}
Define $G_{k}(L) = \sum_{\omega \in L}\omega^{-k}$. Then define the Weierstrass $\wp (z) $ function as follows: 

\begin{equation} 
\wp(z) = \frac{1}{z^{2}} + \sum_{\omega \in L}\left(\frac{1}{(z-\omega)^{2}} - \frac{1}{\omega^{2}}\right) 
\end{equation}  
Then this function can easily be shown, by applications of complex analysis, to be convergent and meromorphic, as well as periodic. Then the derivative $\wp(z)$ is 
\begin{equation} 
\wp ' (z) = -2 \sum_{\omega \in L} \frac{1}{(z- \omega)^{2}} 
\end{equation} 

Now we have a isomorphism from the additive group on $\mathbb{C}/L$ to the the group of elliptic points on $E(\mathbb{C})$, by the map $$z \rightarrow ( \wp(z), \wp' (z)), \> \> \> \> \> 0 \rightarrow O $$ with $E$ being defined as 
\begin{equation} 
E: y^{2} = 4x^{3} - g_{2}x - g_{3} 
\end{equation} 
where $g_{2} = 60G_{4}, g_{3} = 140G_{6}$  
Note that the periodicity will give: 

\begin{equation} 
(\wp(z_{1}), \wp'(z_{1})) \oplus (\wp(z_{2}), \wp'(z_{2})) = (\wp(z_{1} + z_{2}), \wp'(z_{1} + z_{2})) 
\end{equation} which gives rise to the corresponding group law on elliptic curves. 

Now we relate the $j$-invariant on curves to the $j-$function of a complex lattice. First, let rescale our lattice $L$ to $Z\tau + Z$ where $\tau = \frac{w_{1}}{w_{2}}$. First, define $q = e^{2\pi \i \tau}$. Then the j-invariant related to the lattice parameter is 
\begin{equation}
j(\tau) = 1728 \frac{g_{2}^{3}}{g_{2}^{3} - 27 g_{3}^{2}} 
\end{equation} 
 
 
The proof of all of this we won't go into detail in this paper, but this gives rise to the relationship between the complex lattice and isogenies, mainly integer endomorphisms $[m]$ give rise to $ z \rightarrow mz$, and for multiplication by a complex number $c$, we have $z \rightarrow cz$, which will induce a endormorphism on the corresponding elliptic curve.   


For curves defined on a field $K$, there is a homomorphism $K \rightarrow C$ if we linearly map the finite basis elements of $K$, $\alpha_{1}, ...,\alpha_{n}$ respectively to any algebraically independent set of elements in $\mathbb{C}$, $\tau_{1},..., \tau_{n}$, so we can regard $E(K)$ as a curve in $\mathbb{C}$.  

\subsubsection{Using Quadratic Lattices }
Consider the case when our lattice $L = O_{D}$ where $D = \mathbb{Q}(\sqrt{-d})$ for some $d > 0$, where the basis elements will be $[1, \frac{1+\sqrt{-d}}{2}] $ or $[1, \sqrt{-d}]$ depending on whether $d$ is $\{3\}, \{1,2\} \mod 4$ respectively, which are quadratic integer fields. 

Then define the Hilbert Class polynomial $H_{D} \in Z[X]$ that is the minimal polynomial that contains the $j(L)$ as a root. There are many ways to calculate this, but we won't get to that in this paper. Thus, we can define an elliptic curve based on a square free discriminant $D$.  

\subsection{Pairings and Pairing-Friendly Curves}
Let $G$ be an additive abelian group of order $p$, a prime, and let $G'$ be a multiplicative group of order $p$. A pairing is a bilinear map $e: G \times G \to G'$ satisfying:
\begin{enumerate}
\item (bilinearity) $e(P_1 + P_2, P_3) = e(P_1,P_3)e(P_2,P_3) \ \forall P_1,P_2,P_3 \in G$
\item (non-degeneracy) $e(P,P) \ne 1$, where $G = \mathopen{<} P \mathopen{>}$
\item (computability) $e$ is efficiently computable
\end{enumerate} [PAIR91]
\subsubsection{Weil and Tate Pairings}
Let $E[r] = \{ P \in E(\mathbb F_p) \given rP = O\}$ be the $r$-torsion group of $E(\mathbb F_p)$.
\\ \\
\noindent The Weil Pairing is a map $e_r: E[r] \times E[r] \to \mu_r$, where $\mu_{r}$ is the set of $r$th roots of unity in $\overline{\mathbb F_p}$. \\ 

\noindent The Tate Pairing is a map: $\tau_r: E(F_p)[r] \times E(F_p)[r]/ rE(F_p) \to \mu_r$, where $\tau_r(P,Q) = e_r(P, R - \phi_p(R))$, where $R$ satisfies $r R = Q$. [WASH08]



 \subsubsection{Embedding Degree}
 
We do not need the full algebraic closure $\overline{\mathbb F_p}$ to determine $\mu_r$. Instead, we can find a positive integer $k$ such that $\mu_r \subset \mathbb F_{p^k}$, that is, we require only a finite degree algebraic extension. We define the embedding degree $k$ of $E(\mathbb F_p)$ with respect to $r$ as $k:= [\mathbb F_p(\mu_r) : \mathbb F_p]$, the degree of the extension field. Therefore, we can regard $k$ as the smallest positive integer such that $\mu_r \subset \mathbb F_{p^k}$.
\\ \\
\noindent Alternatively, suppose that $k$ is the smallest positive integer such that $\mu_r \subset \mathbb F_{p^k}$.  $\mu_r \subset \mathbb F_{p^k} \iff r \Big |  \# \mathbb F^*_{p^k}$ (since multiplicative groups of finite fields are cyclic) $ \iff \gcd(r, p^k-1) = r \iff p^k-1 \equiv 0 \mod r \iff p$ is a primitive $k$th root of unity mod $r$ (since we picked $k$ to be minimal). 
\\ \\
\noindent Therefore, the embedding degree $k$ is the smallest positive integer satisfying $p^k \equiv 1 \mod r$.

\subsubsection{Pairing-Friendly Curves}
The Weil/Tate Pairing is efficiently computable when $k$ is small, as computing the pairings requires computation in $\mathbb F_{p^k}$. A curve with efficiently computable pairings is {\it pairing-friendly}. Pairing-friendly curves are rare. In general, if $r \approx p$, then $\Pr[$pairing-friendly curve$] = O(\frac{\log^3 M}{M})$

\section{Motivations and Applications} 

\subsection{Discrete Log Problem}
In the discrete log problem, we are given any group $G$, with a base generator element $P$, with a ciphertext $Q$, where the problem involves finding $k$ such that $P^{k} = Q$ in $G$. \\ \\
For elliptic curves, this becomes using a base point $P$ with degree $N$ as a generator, in a finite field $F_{p}$, which will create a cyclic group. However, note that by the theorem of finite abelian groups, this cyclic group will be isomorphic to a direct sum of cyclic groups based on the prime factorization of $N$

\subsubsection{Pohlig-Hellman Attack}
For an element $P$, assume it has order $N$ in the group $G$. Then the prime factorization of $N$, is important to the adversary; i.e. if 
$$ N = \prod_{i}q_{i}^{e_{i}} $$ then if we need to find $k$ such that $P^{k} = Q$, then all we need to do is find $k$ in its base $q_{1}, q_{2},...$ expansions and then construct $k$ using the Chinese Remainder Method. We can do so on each $q_{i}$ by successively iteration. Thus the difficulty of attacking this problem relies on the largest prime dividing $N$. 

This implies that we will need to find elliptic curves that have large-prime order torsion groups. 




\section{Constructing Pairing-Friendly Curves} 

\subsection{Complex Multiplication Method} 

\begin{algorithm}[H]
 \KwIn{$p$, a prime, and $N$ a positive integer}
 \KwOut{An elliptic curve $E(\mathbb F_p)$ where $\#E(\mathbb F_p) = N$}
 $t := p+1 - N$\; 
 $D = $ square free part of $t^2-4p$\;
 $H_D(x) = $ Hilbert class polynomial \\
 Pick $j \in \mathbb F_p$ such that $H_D(j) = 0$
 Compute $E$ according to $(4)$.
 
 \eIf {$\#E(\mathbb F_p) = N$} {
 \Return{ $E$}}
 {\Return quadratic twist of $E$}
 \end{algorithm}
 \bigskip
 

 
 
 
 
 
 
\noindent The above algorithm will always succeed provided that such a curve $E$ exists and $D$ is not too large. A slight subtlety arises if $j = 0$ or $j = 1728$. If $j = 0$, then there are $6$ classes of curves, corresponding to sextic twists of $E$ by $1, \zeta, \zeta^2, \dots, \zeta^5$, for $\zeta$ a primitive root of unity in $\mathbb F_p$. If $j = 1728$, then there are $4$ classes of curves, corresponding to quartic twists of $E$ by $1, \zeta, \dots \zeta^3$, for $\zeta$ a primitive root of unity in $\mathbb F_p$. If a curve $E$ exists, then one of these curves will satisfy the conditions of the algorithm. TODO NEED SOURCE
\\ 
Rationale for this algorithm: 

\subsection{Cocks Pinch Method}

We wish to construct a curve with a subgroup of size $r$ and embedding degree $k$. Suppose we also have chosen a CM discriminant $D$ such that $\legendre{D}{r} = 1$. The Cocks Pinch method finds a prime $p$ and the trace of Frobenius $t$ such that $\exists$ an elliptic curve $E$ over $\mathbb F_p$ with trace $t$, and a subgroup of size $r$ with embedding degree $k$. There are $3$ conditions on $p,t$:
\begin{enumerate}
\item $t^2-4p = f^2 D$, for some $f$. This means that $E$ has CM discriminant $D$
\item $p+1-t \equiv 0 \mod r$. This means that $r \Big | \#E(\mathbb F_p) \implies $ there is a subgroup of size $r$ by the characterization of finitely generated abelian groups
\item $p$ is a primitive $k$th root of unity mod $r$. As mentioned earlier, this condition is equivalent to $E$ having embedding degree $k$ with respect to the subgroup of size $r$.

\end{enumerate}
We see that we only need to satisfy the above $3$ conditions for $p,t$. To do this, we first choose $g$, a primitive $k$th root of unity mod $r$. We know that $t-1 \equiv p \equiv g \mod r$. Using (1), we see that $\frac{(t^2 - f^2 D)}{4} = p$. We can set $a= 2^{-1} (g+1) \mod r$ (as integers). Then, $2 a \equiv g+1 \equiv t \mod r \implies a^2 \equiv \frac{t^2}{4} \mod r$. We can also set $f_0 = \frac{2(a-1)}{\sqrt D} \mod r$. Suppose $p = \frac{(t^2 - f^2_0 D)}{4}$ is prime, and $t = 2a$. Then $p+1 - t \equiv a^2 - (a-1)^2 + 1 - t \equiv 2a -1 + 1 - t \equiv 0 \mod r$, so that (2) is satisfied, and (2) $\implies$ (3) since $t-1 \equiv g$. (1) is satisfied by construction of $p$, and so we have the desired output. If $p$ is not prime, then we can compute $p = \frac{(t^2 - f^2 D)}{4}$ for $f = f_0 + ir$, which gives new values for $p$ while preserving the above congruences mod $r$. If the algorithm succeeds in finding a prime $p$ then it outputs $p,t$, and will output $\bot$ if it fails. The algorithm is given below in pseudocode:
 
\begin{algorithm}[H]
 \KwIn{$k$, embedding degree, $r$, size of subgroup, $D$, CM discriminant with $\legendre{D}{r} = 1$}
 \KwOut{$p$, a prime, and $t$ a trace of Frobenius}
$a := 2^{-1} (g+1) \mod r$ (as integers) \\
$f = \frac{2(a-1)}{d}$ (as integers where $d \equiv \sqrt D \mod r$) \\
$t := 2a$ \\
$p = \frac{(t^2 - f^2 D)}{4}$ \\
\While {$p$ is not prime}{ $f = f + r$\\
$p = \frac{(t^2 - f^2 D)}{4}$ \\
\If{running for too long} {\Return {$\bot$}}
}
\Return{$p,t$}

 \end{algorithm}
 \bigskip 
 
 If the algorithm succeeds, we can use the CM method to construct the desired elliptic curve $E$.



\subsection{Dupont Enge Morain Method}




\bibliographystyle{alpha} 
\bibliography{references}
\end{document}